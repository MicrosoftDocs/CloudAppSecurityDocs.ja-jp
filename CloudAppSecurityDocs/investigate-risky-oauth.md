---
title: 危険な OAuth アプリの調査 - Cloud App Security | Microsoft Docs
description: この記事では、Cloud App Security で危険な OAuth アプリを調査する方法について説明します。
keywords: ''
author: shsagir
ms.author: shsagir
manager: shsagir
ms.date: 9/1/2019
ms.topic: tutorial
ms.collection: M365-security-compliance
ms.prod: ''
ms.service: cloud-app-security
ms.technology: ''
ms.reviewer: reutam
ms.suite: ems
ms.custom: seodec18
ms.openlocfilehash: adb9c8cceaab8158c194256ccd1e5cb0ecbaaa8a
ms.sourcegitcommit: 8a49c166424fea83853b0a6895212367526abe78
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/18/2019
ms.locfileid: "71084356"
---
# <a name="tutorial-investigate-risky-oauth-apps"></a>チュートリアル: 危険な OAuth アプリを調査する

*適用対象:Microsoft Cloud App Security*

OAuth は、トークン ベースの認証と承認のためのオープン標準です。 OAuth を使うと、ユーザーのパスワードを公開せずに、ユーザーのアカウント情報をサード パーティのサービスで使用できます。 OAuth は、ユーザーの代わりに仲介役として機能し、特定のアカウント情報の共有を承認するアクセス トークンをサービスに提供します。

たとえば、ユーザーのカレンダーを分析し、生産性を向上させる方法についてアドバイスを与えるアプリでは、ユーザーのカレンダーに対するアクセスが必要です。 ユーザーの資格情報を提供する代わりに、OAuth を使うと、下の図に見られるように、ページに対してユーザーが同意した場合に生成されるトークンのみに基づいて、アプリでデータにアクセスすることが可能になります。

 ![OAuth アプリのアクセス許可](./media/oauth-permission.png)

組織内のビジネス ユーザーがインストールするサード パーティ製のアプリの多くでは、ユーザー情報とデータにアクセスし、ユーザーの代わりに他のクラウド アプリにサインインするためのアクセス許可が要求されます。 ユーザーは、こうしたアプリをインストールするときに、アプリへのアクセス許可の付与など、プロンプトに表示される詳細をよく確認せずに**承認**をクリックしてしまいがちです。 サード パーティ製アプリのアクセス許可を受け入れることは、組織に対する潜在的なセキュリティ リスクです。

たとえば、次の OAuth アプリの同意ページは、平均的なユーザーにとっては正当なものに見えるかもしれません。しかし、"Google AAPIs Explorer" が Google 自体からアクセス許可を要求する必要はないはずです。 したがって、これはアプリがフィッシングを試みていて、Google とはまったく関係がない可能性があることを示しています。

![OAuth フィッシング](./media/oauth-phishing.png)

セキュリティ管理者には、環境内のアプリに対する可視性と制御が必要です。それにはアプリが持つアクセス許可が含まれます。 取り消したいリソースへのアクセス許可を要求するアプリの使用を禁止する機能が必要です。 そのため、Microsoft Cloud App Security には、ご自身のユーザーが付与したアプリのアクセス許可を調査および監視する機能が用意されています。 この記事では、組織内の OAuth アプリの調査を専門にサポートし、疑わしい可能性が高いアプリに焦点を当てます。

推奨される方法は、Cloud App Security ポータルで提供される機能と情報を使ってアプリを調査し、危険である可能性が低いアプリを除外して、疑わしいアプリに焦点を当てることです。

## <a name="how-to-detect-risky-oauth-apps"></a>危険な OAuth アプリを検出する方法

以下を使って危険な OAuth アプリを検出することができます。

- **アラート**: 既存のポリシーによってトリガーされるアラートに対応します。
- **捜索**:危険に関する具体的な疑いを持たず、利用可能なすべてのアプリ全体で危険なアプリを検索します。

### <a name="detect-risky-apps-using-alerts"></a>アラートを使って危険なアプリを検出する

OAuth アプリが特定の条件を満たした場合に自動的に通知を送信するようにポリシーを設定できます。 たとえば、高いアクセス許可を要求し、50 を超えるユーザーによって承認されたアプリが検出されたときに、自動的に通知するようにポリシーを設定できます。 OAuth のポリシーの作成について詳しくは、「[OAuth アプリに関するポリシー](app-permission-policy.md)」をご覧ください。

### <a name="detect-risky-apps-by-hunting"></a>捜索により危険なアプリを検出する

1. ポータルで、 **[調査]** 、 **[OAuth アプリ]** の順に移動します。 フィルターとクエリを使って、環境内で何が起こっているのか確認します。

    - フィルターを、 **[Permission level high severity]\(アクセス許可レベルの重要度レベル高\)** と **[Community use not common]\(コミュニティの利用状況が頻繁ではない\)** に設定します。 このフィルターを使うと、ユーザーがリスクを過小評価していた可能性のある、潜在的に危険度がとても高いアプリに焦点を当てることができます。
    - **[アクセス許可]** の下で、特定のコンテキストで特に危険であるオプションをすべて選択します。 たとえば、電子メールへのアクセスに対するアクセス許可 ( **[すべてのメールボックスにフル アクセスできます]** など) を提供するすべてのフィルターを選択してから、アプリの一覧を確認して、それらのすべてでメールに関連するアクセスが本当に必要であることを確認できます。 これは、特定のコンテキスト内で調査し、正当に見えるが不要なアクセス許可を含んでいるアプリを見つけるのに役立ちます。 これらのアプリは危険である可能性が高くなります。

            ![OAuth phishing](./media/oauth-filters.png)

    - 保存済みのクエリ **[外部ユーザーによって承認されたアプリ]** を選択します。 このフィルターを使うと、会社のセキュリティ標準に従っていない可能性のあるアプリを見つけることができます。
1. アプリを確認したら、正当に見えて実際には危険である可能性があるクエリ内のアプリに焦点を当てることができます。 フィルターを使ってそれらを検索します。
    - **[Authorized by a small number of users]\(承認したユーザー数が少ない\)** アプリでフィルター処理します。 これらのアプリに焦点を当てると、侵害されたユーザーが承認した危険なアプリを検索できます。
    - アプリの目的に合わないアクセス許可を持っているアプリ (たとえば、すべてのメールボックスにフル アクセスできる時計アプリ)。
1. 各アプリをクリックしてアプリ ドロワーを開き、アプリが不審な名前、発行者、または Web サイトを持っていないかどうかを確認します。
1. アプリの一覧を見て、 **[最後の承認]** の下の日付が最近ではないアプリをターゲットにします。 これらのアプリはもう不要になっている場合があります。

    ![OAuth アプリ ドロワー](./media/oauth-drawer.png)

## <a name="how-to-investigate"></a>調査する方法

アプリが不審であると判断し、それを調査したい場合、効率的な調査のために次の主要な原則を推奨します。

- 組織やオンラインのいずれかでアプリが使われる頻度が多くなればなるほど、それが安全である可能性は高くなります。
- アプリでは、アプリの目的に関連するアクセス許可のみを要求する必要があります。 そうでない場合、アプリは危険である可能性があります。
- 高度な権限や管理者の同意を要求するアプリは、危険である可能性が高くなります。

1. アプリをクリックしてアプリ ドロワーを開き、 **[関連アクティビティ]** の下にあるリンクをクリックします。 これにより、そのアプリで実行されたアクティビティ用にフィルター処理した [アクティビティ ログ] ページが開きます。 一部のアプリで実行されるアクティビティは、ユーザーが実行したものとして登録されることに留意してください。 これらのアクティビティは、[アクティビティ ログ] の結果から自動的に除外されます。 アクティビティ ログを使ったさらなる調査については、[アクティビティ ログ](activity-filters.md)に関するページをご覧ください。
1. アプリが疑わしいと思われる場合は、別のアプリ ストアでそのアプリの名前と発行元を調査することをお勧めします。 疑わしい可能性がある、次のアプリに焦点を当てます。
    - ダウンロード数が少ないアプリ。
    - 評価や点数が低い、または否定的なコメントがあるアプリ。
    - 発行元や Web サイトが疑わしいアプリ。
    - 最終更新日時が最近ではないアプリ。 これは、サポートされなくなったアプリを示している場合があります。
    - 関係のないアクセス許可を持っているアプリ。 これは、アプリが危険であることを示している場合があります。
1. アプリがまだ疑わしい場合は、オンラインでアプリの名前、発行元、URL を調査することができます。
1. OAuth アプリの監査をエクスポートすると、アプリを承認したユーザーをさらに分析することができます。 詳細については、「[OAuth アプリの監査](manage-app-permissions.md#oauth-app-auditing)」をご覧ください。

## <a name="how-to-remediate"></a>修復する方法

ある OAuth アプリが危険であると判断したら、Cloud App Security によって次の修復オプションが提供されます。

- **手動の修復**:簡単に [OAuth アプリ ページからのアプリを禁止/取り消し](manage-app-permissions.md#ban-or-approve-an-app)できます。

- **自動修復**:[自動的にアプリを取り消す、または特定のユーザーをアプリから取り消す](app-permission-policy.md)ポリシーを作成できます。

## <a name="next-steps"></a>次の手順

[クラウド環境を保護するための日常的な作業](daily-activities-to-protect-your-cloud-environment.md)

[Premier サポートをご利用のお客様は、Premier ポータルから直接新しいサポート要求を作成することもできます。](https://premier.microsoft.com/)
