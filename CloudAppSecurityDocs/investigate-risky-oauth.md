---
title: 危険な OAuth アプリを調査する - Cloud App Security
description: この記事では、Cloud App Security で危険な OAuth アプリを調査する方法について説明します。
keywords: ''
author: shsagir
ms.author: shsagir
manager: shsagir
ms.date: 9/1/2019
ms.topic: tutorial
ms.collection: M365-security-compliance
ms.prod: ''
ms.service: cloud-app-security
ms.technology: ''
ms.reviewer: reutam
ms.suite: ems
ms.custom: seodec18
ms.openlocfilehash: 2c6b6ffc3b2c89dc107f223e1f0177df4fa8155b
ms.sourcegitcommit: b15034dd50142afd8e95de22a9232f711b1eae6e
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/01/2020
ms.locfileid: "85624698"
---
# <a name="tutorial-investigate-risky-oauth-apps"></a>チュートリアル:危険な OAuth アプリを調査する

*適用対象:Microsoft Cloud App Security*

OAuth は、トークン ベースの認証と承認を行うためのオープン標準です。 OAuth を使用すると、ユーザーのパスワードを公開せずに、サード パーティのサービスでそのユーザーのアカウント情報を使用できるようになります。 OAuth はユーザーの代わりに仲介役として機能し、特定のアカウント情報の共有を承認するアクセス トークンをサービスに提供します。

たとえば、ユーザーのカレンダーを分析し、生産性を向上させる方法についてアドバイスを与えるアプリでは、ユーザーのカレンダーに対するアクセスが必要です。 ユーザーの資格情報を提供する代わりに、OAuth を使うと、下の図に見られるように、ページに対してユーザーが同意した場合に生成されるトークンのみに基づいて、アプリでデータにアクセスすることが可能になります。

![OAuth アプリのアクセス許可](media/oauth-permission.png)

組織内のビジネス ユーザーがインストールするサード パーティのアプリの多くでは、ユーザー情報とデータにアクセスしたり、ユーザーに代わって他のクラウド アプリにサインインしたりするためのアクセス許可が要求されます。 ユーザーは、このようなアプリをインストールする際に、アプリへのアクセス許可の付与など、プロンプトに表示される詳細を詳しく確認することなく **[同意する]** をクリックすることがよくあります。 サード パーティ製アプリのアクセス許可を受け入れることは、組織に対する潜在的なセキュリティ リスクです。

たとえば、次の OAuth アプリの同意ページは、平均的なユーザーにとっては正当なものに見えるかもしれません。しかし、"Google AAPIs Explorer" が Google 自体からアクセス許可を要求する必要はないはずです。 したがって、これはアプリがフィッシングを試みていて、Google とはまったく関係がない可能性があることを示しています。

![OAuth フィッシング](media/oauth-phishing.png)

セキュリティ管理者には、環境内のアプリに対する可視性と制御が必要です。それにはアプリが持つアクセス許可が含まれます。 取り消したいリソースへのアクセス許可を要求するアプリの使用を禁止する機能が必要です。 そのため、Microsoft Cloud App Security には、ご自身のユーザーが付与したアプリのアクセス許可を調査および監視する機能が用意されています。 この記事の目的は、組織内の OAuth アプリを調査し、疑わしいと思われるアプリに焦点を当てられるようにすることです。

推奨されるアプローチは、Cloud App Security ポータルに用意されている機能と情報を使用してアプリを調査し、危険である可能性が低いアプリを除外して、疑わしいアプリに焦点を当てることです。

## <a name="how-to-detect-risky-oauth-apps"></a>危険な OAuth アプリを検出する方法

以下を使って危険な OAuth アプリを検出することができます。

- **アラート**: 既存のポリシーによってトリガーされるアラートに対応します。
- **捜索**:危険に関する具体的な疑いを持たず、利用可能なすべてのアプリ全体で危険なアプリを検索します。

### <a name="detect-risky-apps-using-alerts"></a>アラートを使って危険なアプリを検出する

OAuth アプリが特定の条件を満たした場合に自動的に通知を送信するようにポリシーを設定できます。 たとえば、高いアクセス許可を要求し、50 を超えるユーザーによって承認されたアプリが検出されたときに、自動的に通知するようにポリシーを設定できます。 OAuth のポリシーの作成について詳しくは、「[OAuth アプリに関するポリシー](app-permission-policy.md)」をご覧ください。

### <a name="detect-risky-apps-by-hunting"></a>捜索により危険なアプリを検出する

1. ポータルで、 **[調査]** > **[OAuth アプリ]** の順に移動します。 フィルターとクエリを使って、環境内で何が起こっているのか確認します。

    - フィルターを、 **[Permission level high severity]\(アクセス許可レベルの重要度レベル高\)** と **[Community use not common]\(コミュニティの利用状況が頻繁ではない\)** に設定します。 このフィルターを使うと、ユーザーがリスクを過小評価していた可能性のある、潜在的に危険度がとても高いアプリに焦点を当てることができます。
    - **[アクセス許可]** の下で、特定のコンテキストで特に危険であるオプションをすべて選択します。 たとえば、電子メールへのアクセスに対するアクセス許可 ( **[すべてのメールボックスにフル アクセスできます]** など) を提供するすべてのフィルターを選択してから、アプリの一覧を確認して、それらのすべてでメールに関連するアクセスが本当に必要であることを確認できます。 これは、特定のコンテキスト内で調査し、正当に見えるが不要なアクセス許可を含んでいるアプリを見つけるのに役立ちます。 これらのアプリは危険である可能性が高くなります。

        ![OAuth フィッシング](media/oauth-filters.png)

    - 保存済みのクエリ **[外部ユーザーによって承認されたアプリ]** を選択します。 このフィルターを使うと、会社のセキュリティ標準に従っていない可能性のあるアプリを見つけることができます。
1. アプリを確認したら、正当に見えて実際には危険である可能性があるクエリ内のアプリに焦点を当てることができます。 フィルターを使ってそれらを検索します。
    - **[Authorized by a small number of users]\(承認したユーザー数が少ない\)** アプリでフィルター処理します。 これらのアプリに焦点を当てると、侵害されたユーザーによって承認された危険なアプリを探すことができます。
    - アプリの目的に合わないアクセス許可を持っているアプリ。たとえば、すべてのメールボックスに対するフル アクセス権を持っている時計アプリなどです。
1. 各アプリをクリックしてアプリ ドロワーを開き、アプリが不審な名前、発行者、または Web サイトを持っていないかどうかを確認します。
1. アプリの一覧を確認して、 **[最後の承認]** の下にある日付が最近ではないアプリを対象にします。 このようなアプリは、不要になっている可能性があります。

    ![OAuth アプリ ドロワー](media/oauth-drawer.png)

## <a name="how-to-investigate"></a>調査方法

アプリが不審であると判断し、それを調査したい場合、効率的な調査のために次の主要な原則を推奨します。

- 組織やオンラインのいずれかでアプリが使われる頻度が多くなればなるほど、それが安全である可能性は高くなります。
- アプリでは、アプリの目的に関連するアクセス許可のみを要求する必要があります。 そうでない場合、アプリは危険である可能性があります。
- 高度な権限や管理者の同意を要求するアプリは、危険である可能性が高くなります。

1. アプリをクリックしてアプリ ドロワーを開き、 **[関連アクティビティ]** の下にあるリンクをクリックします。 これで、そのアプリによって実行されたアクティビティでフィルター処理された [アクティビティ ログ] ページが開きます。 一部のアプリによって実行されるアクティビティは、ユーザーが実行したとして登録されることに注意してください。 このようなアクティビティは、[アクティビティ ログ] の結果から自動的に除外されます。 アクティビティ ログを使用した詳細な調査については、[アクティビティ ログ](activity-filters.md)に関する記事をご覧ください。
1. アプリが疑わしいと思われる場合は、別のアプリ ストアでそのアプリの名前と発行元を調査することをお勧めします。 疑わしい可能性がある、次のようなアプリに焦点を当てます。
    - ダウンロード数が少ないアプリ。
    - 低い評価やスコア、または悪いコメントが付けられているアプリ。
    - 発行元や Web サイトが疑わしいアプリ。
    - 最終更新日時が最近ではないアプリ。 これは、アプリがもうサポートされていないことを示している可能性があります。
    - 無関係なアクセス許可を持つアプリ。 これは、アプリが危険であることを示している可能性があります。
1. アプリがまだ疑わしい場合は、そのアプリの名前、発行元、および URL をオンラインで調べることができます。
1. OAuth アプリの監査をエクスポートすると、アプリを承認したユーザーをさらに分析することができます。 詳細については、「[OAuth アプリの監査](manage-app-permissions.md#oauth-app-auditing)」をご覧ください。

## <a name="how-to-remediate"></a>修復する方法

ある OAuth アプリが危険であると判断したら、Cloud App Security によって次の修復オプションが提供されます。

- **手動の修復**:簡単に [OAuth アプリ ページからのアプリを禁止/取り消し](manage-app-permissions.md#ban-or-approve-an-app)できます。

- **自動修復**:[自動的にアプリを取り消す、または特定のユーザーをアプリから取り消す](app-permission-policy.md)ポリシーを作成できます。

## <a name="next-steps"></a>次のステップ

> [!div class="nextstepaction"]
> [クラウド環境を保護するための日常的な作業](daily-activities-to-protect-your-cloud-environment.md)

[!INCLUDE [Open support ticket](includes/support.md)]
