---
title: クラウドアプリでファイルを監視および保護する-Cloud App Security |Microsoft Docs
description: この記事では、組織のクラウドアプリで使用されるデータとファイルを監視および制御するためのデータポリシーを設定する手順について説明します。
keywords: ''
author: shsagir
ms.author: shsagir
manager: shsagir
ms.date: 10/7/2019
ms.topic: conceptual
ms.collection: M365-security-compliance
ms.prod: ''
ms.service: cloud-app-security
ms.technology: ''
ms.reviewer: reutam
ms.suite: ems
ms.custom: seodec18
ms.openlocfilehash: 7c309455b6c7c5a1d46421316eb589038f162726
ms.sourcegitcommit: 288c279a0d2dd62a8ad8d7425c3e9e98857bf5f4
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/05/2020
ms.locfileid: "80666487"
---
# <a name="file-policies"></a>ファイル ポリシー

*適用対象: Microsoft Cloud App Security*

ファイルポリシーを使用すると、クラウドプロバイダーの Api を使用して、さまざまな自動プロセスを適用できます。 ポリシーを設定して、継続的なコンプライアンススキャン、法的な電子情報開示タスク、一般公開されている機密コンテンツの DLP、その他多数のユースケースを提供できます。 Cloud App Security は、20を超えるメタデータフィルター (アクセスレベル、ファイルの種類など) に基づいて任意のファイルの種類を監視できます。

## <a name="supported-file-types"></a>サポートされているファイルの種類

Cloud App Security の組み込み DLP エンジンは、Office、Open Office、圧縮ファイル、さまざまなリッチテキスト形式、XML、HTML などを含む、すべての共通ファイルタイプ (100 以上) からテキストを抽出することによってコンテンツ検査を実行します。

## <a name="policies"></a>ポリシー

エンジンは、各ポリシーの下に次の3つの側面を結合します。

* プリセットテンプレートまたはカスタム式に基づくコンテンツスキャン。

* ユーザーロール、ファイルメタデータ、共有レベル、組織グループの統合、共同作業のコンテキスト、その他のカスタマイズ可能な属性を含むコンテキストフィルター。

* ガバナンスと修復のための自動化されたアクション。 詳細については、「 [Control](control.md)」を参照してください。
    > [!NOTE]
    > 最初にトリガーされたポリシーのガバナンスアクションだけが適用されることが保証されます。 たとえば、ファイルポリシーによってファイルに AIP ラベルが既に適用されている場合、2番目のファイルポリシーで別の AIP ラベルを適用することはできません。

有効にすると、ポリシーは、クラウド環境を継続的にスキャンし、コンテンツおよびコンテキストフィルターに一致するファイルを特定し、要求された自動アクションを適用します。 これらのポリシーは、保存中の情報の違反、または新しいコンテンツが作成されたときに、違反を検出して修復します。 ポリシーは、リアルタイムのアラートを使用するか、コンソールによって生成されるレポートを使用して監視できます。

作成可能なファイルポリシーの例を次に示します。

* **公開共有ファイル**-共有レベルがパブリックであるすべてのファイルを選択することによって、クラウド内のパブリックに共有されているファイルに関するアラートを受け取ります。

* **公開共有ファイル名には組織の名前が含まれ**、組織の名前を含むファイルに関するアラートを受け取り、一般に共有されます。 組織の名前を含むファイル名と、一般に共有されているファイルを選択します。

* **外部ドメインとの共有**-特定の外部ドメインが所有するアカウントと共有されているファイルに関するアラートを受け取ります。 たとえば、競合他社のドメインで共有されているファイルなどです。 共有を制限する外部ドメインを選択します。

* **[最後の期間に変更されていない共有ファイルを検疫**する]-最近変更されていない共有ファイルに関するアラートを受信し、検疫を行うか、自動アクションを有効にするかを選択します。 指定した日付範囲内に変更されていないプライベートファイルをすべて除外します。 G Suite では、ポリシー作成ページの [検疫ファイル] チェックボックスを使用して、これらのファイルを検疫するように選択できます。

* **承認されていないユーザーとの共有**-組織内の承認されていないユーザーグループと共有されているファイルに関するアラートを受け取ります。 共有が許可されていないユーザーを選択します。

* **機密性の高いファイル拡張子**-公開される可能性のある特定の拡張子を持つファイルに関するアラートを受け取ります。 特定の拡張機能 (証明書の場合は crt など) またはファイル名を選択し、プライベート共有レベルのファイルを除外します。

## <a name="create-a-new-file-policy"></a>新しいファイルポリシーを作成する

新しいファイルポリシーを作成するには、次の手順に従います。

1. コンソールで、 **[制御]** 、 **[ポリシー]** の順にクリックします。

1. **[ポリシーの作成]** をクリックし、 **[ファイル]** ポリシー を選択します。

1. ポリシーの名前と説明を指定します。テンプレートに基づいて作成する場合は、ポリシーを使用して[クラウドアプリを制御](control-cloud-apps-with-policies.md)する方法に関する記事を参照してください。

1. ポリシーにポリシーの**重要度**を指定します。 特定のポリシー重要度レベルのポリシー一致に関する通知を送信するように Cloud App Security を設定している場合、このレベルを使用して、ポリシーの一致が通知をトリガーするかどうかを判断します。

1. **[カテゴリ]** で、最も適切なリスクの種類にポリシーをリンクします。 このフィールドは有益な情報であり、リスクの種類に基づいて、後で特定のポリシーとアラートを検索するのに役立ちます。  このリスクは、ポリシーの作成先として選択したカテゴリに従って既に選択されている場合があります。 既定では、ファイルポリシーは DLP に設定されています。

1. このポリシー**が適用されるファイルのフィルターを作成して、検出されたアプリが**このポリシーをトリガーするように設定します。 ポリシーフィルターを絞り込むと、操作対象のファイルの正確なセットに達するまで除外されます。 偽陽性を回避するには、可能な限り制限してください。 たとえば、パブリックのアクセス許可を削除する場合は、**パブリック**フィルターを追加することを忘れないでください。外部ユーザーを削除する場合は、"外部" フィルターを使用します。
   > [!NOTE]
   > ポリシーフィルターを使用する場合、には、完全な単語の検索だけ**が含まれ**ます (comas、ドット、スペース、またはアンダースコアで区切られています)。 たとえば、**マルウェア**または**ウイルス**を検索すると、virus_malware_file が検出されますが、malwarevirusfile.exe は見つかりません。 **マル**ウェアを検索すると、ファイル名にマルウェアまたは exe のいずれかを含むすべてのファイルが検索されます。一方、 **"sysprep.exe"** (二重引用符を含む) を検索すると、完全に "sysprep.exe" を含むファイルのみが検索されます。 **Equals**は、完全な文字列のみを検索します。たとえば、**マル**ウェアを検索すると、マルウェアの .exe ではなく、マルウェアが検出されます。
1. 最初の **[適用先]** フィルターの下で、[**選択したフォルダーを除くすべてのファイル**、または Box、SharePoint、Dropbox、OneDrive の**選択されたフォルダー**を除くすべてのファイル] を選択します。ここで、アプリまたは特定のフォルダーのすべてのファイルにファイルポリシーを適用できます。 クラウドアプリへのサインインにリダイレクトされ、関連するフォルダーが追加されます。

1. 2番目の **[適用先]** フィルターで、 **[すべてのファイル所有者]** 、 **[選択したユーザーグループのファイル所有]** 者、または **[選択したグループを除くすべてのファイル所有]** 者 を選択します 次に、関連するユーザーグループを選択して、ポリシーに含めるユーザーとグループを決定します。

1. **[コンテンツ検査方法]** を選択します。 [**組み込みの DLP**](content-inspection-built-in.md)または[**データ分類サービス**](content-inspection.md)のいずれかを選択できます。 **データ分類サービス**を使用することをお勧めします。

    コンテンツ検査が有効になったら、事前設定された式を使用するか、他のカスタマイズされた式を検索するかを選択できます。

    また、正規表現を指定して、結果からファイルを除外することもできます。 このオプションは、ポリシーから除外する内部分類キーワード標準がある場合に非常に便利です。

    ファイルが違反と見なされる前に、一致させるコンテンツ違反の最小数を設定できます。 たとえば、10個以上のクレジットカード番号が含まれているファイルについて警告を表示する場合は、10を選択できます。

    選択した式とコンテンツが一致すると、違反テキストが "X" 文字に置き換えられます。 既定では、違反はマスクされ、違反の前後に100文字が表示されます。 式のコンテキスト内の数値は "#" 文字に置き換えられ、Cloud App Security 内には格納されません。 違反の最後の4文字をマスク**解除するオプション**を選択すると、違反自体の最後の4文字をマスク解除できます。 正規表現で検索するデータ型 (コンテンツ、メタデータ、ファイル名) を設定する必要があります。 既定では、コンテンツとメタデータが検索されます。

1. 一致が検出されたときに実行する Cloud App Security**ガバナンス**アクションを選択します。

1. ポリシーを作成したら、 **[ファイルポリシー]** タブでポリシーを表示できます。いつでも、ポリシーを編集したり、フィルターを調整したり、自動アクションを変更したりできます。 ポリシーは作成時に自動的に有効になり、すぐにクラウドファイルのスキャンを開始します。  ガバナンスアクションを設定すると、ファイルへのアクセス許可が失われる可能性があります。 複数の検索フィールドを使用して、操作するファイルを正確に表すようにフィルターを絞り込むことをお勧めします。 フィルターの幅が狭いほど、パフォーマンスが向上します。 ガイダンスについては、フィルター セクションの **結果の編集とプレビュー** ボタンを使用できます。

    ![ファイルポリシーの編集と結果のプレビュー](media/file-policy-edit-and-preview-results.png)

1. ファイルポリシーの一致を表示するには、ポリシーに違反している可能性のあるファイルをクリックし、 **[制御]** 、 **[ポリシー]** の順にクリックします。 上部にある**型**フィルターを使用して、結果をフィルター処理してファイルポリシーのみを表示します。 各ポリシーの一致の詳細については、ポリシーをクリックしてください。 これにより、ポリシーの "現在の一致" ファイルが表示されます。 **[履歴]** タブをクリックすると、ポリシーに一致したファイルの履歴が最大6か月まで表示されます。

## <a name="file-policy-reference"></a>ファイルポリシーリファレンス

ここでは、ポリシーの詳細について説明し、各ポリシーの種類と、各ポリシーに構成できるフィールドについて説明します。

**ファイルポリシー**は API ベースのポリシーであり、20を超えるファイルメタデータフィルター (所有者と共有レベルを含む) とコンテンツ検査の結果を考慮して、クラウド内の組織のコンテンツを制御できます。 ポリシーの結果に基づいて、ガバナンスアクションを適用できます。 コンテンツ検査エンジンは、サードパーティの DLP エンジンや、マルウェア対策ソリューションを使用して拡張できます。

各ポリシーは、次の部分で構成されています。

* **ファイルフィルター** –メタデータに基づいて粒度の細かい条件を作成できます。

* **コンテンツ検査**– DLP エンジンの結果に基づいてポリシーを絞り込むことができます。 カスタム式またはプリセット式を含めることができます。 除外を設定することができ、一致の数を選択できます。 匿名化を使用してユーザー名をマスクすることもできます。

* **アクション**–ポリシーは、違反が見つかったときに自動的に適用できる一連のガバナンスアクションを提供します。  これらのアクションは、コラボレーションアクション、セキュリティアクション、調査アクションに分かれています。

* **拡張機能**-コンテンツ検査は、DLP またはマルウェア対策機能を向上させるために、サードパーティ製エンジンを使用して実行できます。

## <a name="file-queries"></a>ファイルクエリ

調査をさらに簡単にするために、カスタムクエリを作成し、後で使用できるように保存することができます。

1. **[ファイル]** ページで、前述のフィルターを使用して、必要に応じてアプリにドリルダウンします。

1. クエリの作成が完了したら、フィルターの右上隅にある **[名前を付けて保存]** ボタンをクリックします。

1. **[クエリの保存]** ポップアップで、クエリに名前を付けます。

1. 今後、このクエリを使用するには、 **[クエリ]** で下にスクロールして **[保存されたクエリ]** を選択し、クエリを選択します。

## <a name="next-steps"></a>次のステップ:

> [!div class="nextstepaction"]
> [クラウド環境を保護するための日常的な作業](daily-activities-to-protect-your-cloud-environment.md)

[!INCLUDE [Open support ticket](includes/support.md)]
