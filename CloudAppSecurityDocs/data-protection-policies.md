---
title: クラウド アプリのファイルを監視および保護する - Cloud App Security | Microsoft Docs
description: この記事では、組織のクラウド アプリ使用においてデータとファイルを監視および制御するためのデータ ポリシーを設定する手順について説明します。
keywords: ''
author: shsagir
ms.author: shsagir
manager: shsagir
ms.date: 10/7/2019
ms.topic: conceptual
ms.collection: M365-security-compliance
ms.prod: ''
ms.service: cloud-app-security
ms.technology: ''
ms.reviewer: reutam
ms.suite: ems
ms.custom: seodec18
ms.openlocfilehash: 7391832b1be0ed9b50d54f22ee324879fd588d38
ms.sourcegitcommit: 207543b3f7d0489b1275d20c3543964bc6525d1a
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/07/2019
ms.locfileid: "71995987"
---
# <a name="file-policies"></a>ファイル ポリシー

*適用対象:Microsoft Cloud App Security*

ファイル ポリシーでは、クラウド プロバイダーの API を使用して、さまざまな自動プロセスを適用できます。 ポリシーを設定することにより、継続的なコンプライアンスのスキャン、法的な電子情報開示タスク、一般公開された機密コンテンツの DLP、その他多数のユース ケースを実現できます。 Cloud App Security は、20 を超えるメタデータ フィルター (アクセス レベルやファイルの種類など) に基づいてファイルの種類を監視できます。

### <a name="supported-file-types"></a>サポートされているファイルの種類

Cloud App Security に組み込まれている DLP エンジンは、Office、Open Office、圧縮ファイル、さまざまなリッチ テキスト形式、XML、HTML など、100 を超えるすべての一般的なファイルの種類からテキストを抽出することにより、コンテンツの検査を実行します。

## <a name="policies"></a>ポリシー

このエンジンは、各ポリシーの 3 つの要素を統合します。

* 設定済みのテンプレートまたはカスタム式に基づくコンテンツのスキャン。

* ユーザー ロール、ファイルのメタデータ、共有レベル、組織グループの統合、共同作業のコンテキスト、その他のカスタマイズ可能な属性を含むコンテキスト フィルター。

* 自動化されたガバナンスおよび修復アクション。 詳細については、「[制御](control.md)」を参照してください。
    > [!NOTE]
    > ファイルごとに適用できるガバナンスアクションは1つだけです。このため、ファイルに複数のファイルポリシー一致がある場合、最初にトリガーされたポリシーのガバナンスアクションが適用されます。 たとえば、ファイルポリシーによってファイルに AIP ラベルが既に適用されている場合、2番目のファイルポリシーでは、ファイルを管理者検疫に移動することはできません。

ポリシーを有効化すると、クラウド環境を継続的にスキャンし、コンテンツおよびコンテキスト フィルターに一致するファイルを特定して、要求された自動アクションを適用します。 これらのポリシーは、保存中の情報や新しいコンテンツの作成時に違反を検出して修復します。 ポリシーは、リアルタイムのアラートまたはコンソールから生成されたレポートを使用して監視できます。

作成可能なファイル ポリシーの例を以下に示します。

* **公開共有ファイル** - クラウド内の一般公開されているファイルに関するアラートを受け取ります。共有レベルがパブリックになっているすべてのファイルを選択します。

* **組織の名前が含まれる公開共有ファイル名** - お客様の組織の名前が含まれ、一般公開されているファイルに関するアラートを受け取ります。 ファイル名にお客様の組織の名前が含まれ、一般公開されているファイルを選択します。

* **外部ドメインとの共有** - 特定の外部ドメインで所有されているアカウントと共有されるファイルに関するアラートを受け取ります。 たとえば、競合他社のドメインと共有されるファイルに関してです。 共有を制限する外部ドメインを選択します。

* **一定期間変更されていない共有ファイルの検疫** - 最近変更されていない共有ファイルに関するアラートを受け取り、検疫を行うか、自動アクションを有効にします。 指定した期間中に変更されなかったプライベート ファイルはすべて除外します。 G Suite では、ポリシー作成ページの [quarantine file (検疫ファイル)] チェックボックスを使用して、これらのファイルを検疫するように選択できます。

* **承認されていないユーザーとの共有** - 組織内の承認されていないユーザー グループと共有されているファイルに関するアラートを受け取ります。 共有が承認されていないユーザーを選択します。

* **機密性の高いファイル拡張子** - 広く公開される可能性のある、特定の拡張子を持つファイルに関するアラートを受け取ります。 特定の拡張子 (証明書の場合は crt など) またはファイル名を選択し、共有レベルがプライベートになっているファイルを除外します。

## <a name="create-a-new-file-policy"></a>新しいファイルを作成する

新しいファイル ポリシーを作成するには、以下の手順を実行します。

1. コンソールで、 **[制御]** 、 **[ポリシー]** の順にクリックします。

1. **[ポリシーの作成]** をクリックして **[ファイル]** ポリシーを選択します。

1. ポリシーの名前と説明を入力します。この場合、ポリシー テンプレートを使用することもできます。ポリシー テンプレートの詳細については、「[Control cloud apps with policies (ポリシーによるクラウド アプリの制御)](control-cloud-apps-with-policies.md)」を参照してください。

1. ポリシーに**ポリシー重要度**を指定します。 特定のポリシー重要度レベルでポリシーが一致したときに通知を送信するように Cloud App Security を設定している場合、このレベルを使用し、そのポリシーの一致で通知がトリガーされるかどうかを決定します。

1. **[カテゴリ]** から、最も適切なリスクの種類にポリシーをリンクします。 このフィールドは、情報提供のみを目的としたもので、後からリスクの種類に基づいて特定のポリシーやアラートを検索する場合に役立ちます。  リスクは、ポリシーを作成したカテゴリに応じて、既に選択されている可能性があります。 既定では、ファイル ポリシーは DLP に設定されています。

1. 検出された場合にこのポリシーをトリガーするアプリを設定するには、**このポリシーの対象となるファイルのためのフィルターを作成**します。 ポリシーの対象となる正確なファイル セットが表示されるまで、ポリシー フィルターの条件を絞り込みます。 誤検知を回避するために、可能な限り限定してください。 たとえば、パブリックのアクセス許可を削除するには、**パブリック** フィルターを追加し、外部ユーザーを削除するには、"外部" フィルターを使用します。
   > [!NOTE]
   > ポリシー フィルターを使用する場合、 **[が次を含む]** を選択すると、コンマ、ピリオド、スペース、アンダースコアで区切られた完全に一致する単語のみが検索されます。 たとえば、**malware** または **virus** を検索する場合、virus_malware_file.exe は検出されますが、malwarevirusfile.exe は検出されません。 **malware.exe** を検索すると、ファイル名に malware または exe のいずれかを含むすべてのファイルが検出されますが、 **"malware.exe"** (二重引用符を含む) を検索すると、malware.exe がそのまま名前に含まれるファイルのみが検出されます。 **[が次と等しい]** を使用して検索すると、完全な文字列のみが検索されます。たとえば、**malware.exe** を検索すると、malware.exe は検出されますが、malware.exe.txt は検出されません。
1. 最初の **[適用先]** フィルターで、Box、SharePoint、Dropbox、OneDrive に対して **選択したフォルダーを除くすべてのファイル**または**選択したフォルダー**を選びます。アプリまたは特定のフォルダーのすべてのファイルにファイル ポリシーを強制できます。 クラウド アプリのサインインにリダイレクトされます。その後、関連フォルダーを追加します。

1. 2 つ目の **[適用先]** フィルターで、**すべてのファイル所有者**、**選択されたユーザー グループのファイル所有者**、**選択されたグループを除くすべてのファイル所有者**のいずれかを選択します。 次に、関連するユーザー グループを選択し、ポリシーに含める必要があるユーザーとグループを決定します。

1. **[コンテンツ検査方法]** を選択します。 [ **[組み込み DLP]** ](content-inspection-built-in.md) または [ **[Data Classification Services]** ](content-inspection.md)\(データ分類サービス\) のどちらかを選択できます。 **[Data Classification Services]** \(データ分類サービス\) を使用することをお勧めします。

    コンテンツ検査を有効にすると、現在の式を使用するか、またはそれ以外のカスタマイズされた式を検索することを選択できます。

    また、正規表現を指定して、結果からファイルを除外することもできます。 このオプションは、内部分類キーワード標準をポリシーから除外する場合に非常に便利です。

    ファイルが違反と見なされる前に、一致する必要のあるコンテンツ違反の最小数を設定できます。 たとえば、最低 10 個のクレジット カード番号が検出されたファイルについてアラートを受け取る場合は、10 を選択します。

    選択された式とコンテンツが一致すると、違反テキストが "X" 文字に置き換えられます。 既定では、違反はマスクされており、コンテキストの違反の前後の 100 文字が示されています。 式のコンテキスト内の数字は "#" 文字に置き換えられ、Cloud App Security 内に保存されることはありません。 **[Unmask the last 4 characters of a violation]** \(違反の最後の 4 文字のマスクを解除する) オプションを選択すると、違反自体の最後の 4 文字のマスクを解除することができます。 正規表現で検索するデータ型 (コンテンツ、メタデータ、またはファイル名) を設定する必要があります。 既定では、コンテンツとメタデータが検索されます。

1. Cloud App Security で一致が検出された場合に実行する **[ガバナンス]** アクションを選択します。

1. 作成したポリシーは、 **[ファイル ポリシー]** タブに表示されます。ポリシーはいつでも編集して、フィルターを調整したり、自動アクションを変更したりできます。 ポリシーは作成時に自動的に有効化され、すぐにクラウド ファイルのスキャンを開始します。  ガバナンス アクションを設定する場合には十分に注意してください。ファイルへのアクセス許可が失われ、元に戻せなくなる可能性があります。 複数の検索フィールドを使用して、ポリシーを実行する対象ファイルのみが表示されるようにフィルター条件を絞り込むことをお勧めします。 フィルター条件を絞り込むほど、適切な結果が得られます。 フィルター セクションの **結果の編集とプレビュー** ボタンを使用すると結果を確認できます。

    ![ファイル ポリシーの編集とプレビュー結果](./media/file-policy-edit-and-preview-results.png)

1. ファイル ポリシーの一致 (ポリシーに違反する可能性があるファイル) を表示するには、 **[制御]** をクリックして、 **[ポリシー]** をクリックします。 上部にある **[種類]** フィルターを使用して、ファイル ポリシーだけを表示するように結果をフィルター処理します。 各ポリシーの一致に関する詳細については、ポリシーをクリックします。 これで、ポリシーに対して "現在一致している" ファイルが表示されます。 **[履歴]** タブをクリックすると、ポリシーに一致したファイルの履歴が最大過去 6 か月まで表示されます。

## <a name="file-policy-reference"></a>ファイル ポリシーの参照

このセクションでは、各ポリシーの種類、ポリシーごとに設定できるフィールドなど、ポリシーの詳細を説明します。

**ファイル ポリシー**は、クラウド内にある組織のコンテンツを制御できる API ベースのポリシーであり、20 を超えるファイル メタデータ フィルター (所有者および共有レベルを含む) とコンテンツ検査の結果が考慮されます。 ポリシーの結果に基づいて、ガバナンス アクションを適用できます。 コンテンツ検査エンジンは、アンチマルウェア ソリューションと同様にサードパーティの DLP エンジンを使用しても拡張できます。

各ポリシーは、次の部分で構成されます。

* **ファイル フィルター** – メタデータに基づいた詳細の条件を作成できます。

* **コンテンツ検査** – DLP エンジンの結果に基づいてポリシーを絞り込むことができます。 カスタム式、または事前設定された式を含めることができます。 除外リストの設定および一致数の選択が可能です。 匿名化を使用してユーザー名をマスクすることもできます。

* **アクション** – ポリシーにガバナンス アクションが複数記載されており、違反が発見されたときにこれらのアクションが自動的に適用されます。  これらのアクションは、コラボレーション アクション、セキュリティ アクション、調査アクションに分かれます。

* **拡張機能** - コンテンツ検査はサードパーティ エンジン経由で実行でき、DLP またはマルウェア対策機能が向上します。

## <a name="file-queries"></a>ファイルクエリ

調査をさらに簡単にするために、カスタム クエリを作成し、それを後で使用するために保存できるようになりました。

1. **[ファイル]** ページで、前述のフィルターを使用して、必要に応じてアプリにドリルダウンします。

1. クエリのビルドが終了したら、フィルターの右上隅にある **[名前を付けて保存]** ボタンをクリックします。

1. **[クエリの保存]** ポップアップでクエリに名前を付けます。

1. このクエリを今後もう一度使用するには、 **[クエリ]** の下で、下方向にスクロールして **[保存されたクエリ]** を表示し、クエリを選択します。

## <a name="next-steps"></a>次の手順

[クラウド環境を保護するための日常的な作業](daily-activities-to-protect-your-cloud-environment.md)

[Premier サポートをご利用のお客様は、Premier ポータルから直接新しいサポート要求を作成することもできます。](https://premier.microsoft.com/)
