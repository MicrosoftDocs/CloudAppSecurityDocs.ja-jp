---
title: クラウド アプリでファイルを監視および保護する - Cloud App Security
description: この記事では、組織のクラウド アプリで使用されるデータとファイルを監視および制御するためのデータ ポリシーを設定する手順について説明します。
keywords: ''
author: shsagir
ms.author: shsagir
manager: shsagir
ms.date: 10/7/2019
ms.topic: conceptual
ms.collection: M365-security-compliance
ms.prod: ''
ms.service: cloud-app-security
ms.technology: ''
ms.reviewer: reutam
ms.suite: ems
ms.custom: seodec18
ms.openlocfilehash: 317595b377d19b1d6f9a06b316cb14e4d1ad4c1c
ms.sourcegitcommit: b15034dd50142afd8e95de22a9232f711b1eae6e
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/01/2020
ms.locfileid: "85624589"
---
# <a name="file-policies"></a>ファイル ポリシー

*適用対象:Microsoft Cloud App Security*

ファイル ポリシーを使用すると、クラウド プロバイダーの API を使用して、さまざまな自動プロセスを適用できます。 ポリシーを設定することで、継続的なコンプライアンス スキャン、法的な電子情報開示タスク、一般公開されている機密コンテンツの DLP、その他多数のユースケースを行うことができます。 Cloud App Security では、20 を超えるメタデータ フィルター (アクセス レベルやファイルの種類など) に基づいて任意のファイルの種類を監視できます。

## <a name="supported-file-types"></a>サポートされているファイルの種類

Cloud App Security の組み込み DLP エンジンは、Office、Open Office、圧縮ファイル、各種のリッチ テキスト形式、XML、HTML などを含む、一般的なすべてのファイル タイプ (100 以上) からテキストを抽出することによって、コンテンツ検査を実行します。

## <a name="policies"></a>ポリシー

このエンジンは、各ポリシーで次の 3 つの特性を組み合わせています。

* プリセット テンプレートまたはカスタム式に基づくコンテンツ スキャン。

* ユーザー ロール、ファイル メタデータ、共有レベル、組織グループの統合、コラボレーションのコンテキスト、その他のカスタマイズ可能な属性を含むコンテキスト フィルター。

* ガバナンスと修復のための自動アクション。 詳細については、「[制御](control.md)」を参照してください。
    > [!NOTE]
    > 最初にトリガーされたポリシーのガバナンス アクションの適用のみが保証されます。 たとえば、ファイル ポリシーによってファイルに AIP ラベルが既に適用されている場合は、2 番目のファイル ポリシーで別の AIP ラベルを適用することはできません。

ポリシーを有効にすると、クラウド環境が継続的にスキャンされ、コンテンツおよびコンテキスト フィルターに一致するファイルが特定され、要求された自動アクションが適用されます。 これらのポリシーは、保存中の情報や新しいコンテンツの作成時に違反を検出して修復します。 ポリシーを監視するには、リアルタイムのアラートまたはコンソールで生成されたレポートを使用します。

作成可能なファイル ポリシーの例を次に示します。

* **公開共有ファイル** - 共有レベルがパブリックに設定されているすべてのファイルを選択して、クラウド内のパブリックに共有されているファイルに関するアラートを受け取ります。

* **公開共有ファイル名に組織名が含まれている** - ファイル名に組織名が含まれていて、パブリックに共有されているファイルに関するアラートを受け取ります。 ファイル名に組織名が含まれていて、パブリックに共有されているファイルを選択します。

* **外部ドメインとの共有** - 特定の外部ドメインが所有するアカウントと共有されているファイルに関するアラートを受け取ります。 たとえば、競合他社のドメインと共有されているファイルなどです。 共有を制限する外部ドメインを選択します。

* **最後の期間に変更されていない共有ファイルの検疫** - 最近変更されていない共有ファイルに関するアラートを受信し、検疫を行うか、自動アクションを有効にすることを選択します。 指定した日付範囲内に変更されなかったプライベート ファイルをすべて除外します。 G Suite では、ポリシー作成ページの [検疫ファイル] チェックボックスを使用して、これらのファイルを検疫するように選択できます。

* **承認されていないユーザーとの共有** - 組織内の承認されていないユーザーのグループと共有されているファイルに関するアラートを受け取ります。 共有が許可されていないユーザーを選択します。

* **機密性の高いファイルの拡張子** - 広く公開される可能性のある、特定の拡張子を持つファイルに関するアラートを受け取ります。 特定の拡張子 (証明書の場合は crt など) またはファイル名を選択し、共有レベルがプライベートのファイルを除外します。

## <a name="create-a-new-file-policy"></a>新しいファイル ポリシーを作成する

新しいファイル ポリシーを作成するには、次の手順に従います。

1. コンソールで、 **[制御]** 、 **[ポリシー]** の順にクリックします。

1. **[ポリシーの作成]** をクリックし、 **[ファイル ポリシー]** を選択します。

1. ポリシーに名前を付けて説明を加えます。必要に応じて、テンプレートのベースにすることができます。ポリシー テンプレートの詳細については、「[ポリシーによるクラウド アプリの制御](control-cloud-apps-with-policies.md)」を参照してください。

1. ポリシーに **[ポリシー重要度]** を指定します。 特定のポリシー重要度レベルに関するポリシーの一致の通知を送信するように Cloud App Security を設定している場合は、このレベルを使用して、ポリシーの一致によって通知がトリガーされるかどうかを決定します。

1. **[カテゴリ]** 内で、最適なリスクの種類にポリシーをリンクします。 このフィールドは情報のためのフィールドであり、後でリスクの種類に基づいて、特定のポリシーとアラートを検索するために役立ちます。  リスクは、ポリシーの作成先として選択したカテゴリに従って事前に選択されている場合があります。 既定では、ファイル ポリシーは DLP に設定されます。

1. **[このポリシーの対象となるファイルのためのフィルターを作成]** を選択して、このポリシーをトリガーする検出されたアプリを設定します。 処置する対象のファイルのセットになるまで、厳密にポリシー フィルターを絞り込みます。 偽陽性を回避するために、可能な限り制限を加えてください。 たとえば、パブリックのアクセス許可を削除する場合は、 **[パブリック]** フィルターを追加してください。外部ユーザーを削除する場合は、[外部] フィルターを使用します。
   > [!NOTE]
   > ポリシー フィルターを使用する場合、 **[次の値を含む]** では、コンマ、ピリオド、スペース、またはアンダースコアで区切られた完全な単語のみが検索されます。 たとえば、**malware** または **virus** を検索すると、virus_malware_file.exe は検出されますが、malwarevirusfile.exe は検出されません。 **malware.exe** を検索すると、ファイル名に malware または exe のいずれかを含むすべてのファイルが検索されますが、 **“malware.exe”** (引用符で囲まれている) を検索した場合は、正確に "malware.exe" を含むファイルのみが検索されます。 **[次の値と等しい]** では、完全な文字列のみが検索されます。たとえば、**malware.exe** を検索すると、malware.exe は検出されますが、malware.exe.txt は検出されません。
1. 最初の **[適用対象]** フィルターで、Box、SharePoint、Dropbox、OneDrive に対して、 **[選ばれたフォルダーを除くすべてのファイル]** または **[選ばれたフォルダー]** を選択します。これらのクラウド アプリでは、ファイル ポリシーをアプリのすべてのファイルまたは特定のフォルダーに適用できます。 クラウド アプリへのサインインにリダイレクトされるので、関連するフォルダーを追加します。

1. 2 番目の **[適用対象]** フィルターで、 **[すべてのファイル所有者]** 、 **[選択されたユーザー グループのファイル所有者]** 、または **[all file owners excluding selected groups]** \(選択したグループを除くすべてのファイル所有者\) を選択します。 次に、関連するユーザー グループを選択して、ポリシーに含めるユーザーとグループを決定します。

1. **[コンテンツ検査方法]** を選択します。 [ **[組み込み DLP]** ](content-inspection-built-in.md) または [ **[データ分類サービス]** ](content-inspection.md) を選択できます。 **[データ分類サービス]** を使用することをお勧めします。

    コンテンツ検査を有効にしたら、事前設定された式を使用するか、他のカスタマイズされた式を検索するかを選択できます。

    また、正規表現を指定して、結果からファイルを除外することもできます。 このオプションは、ポリシーから除外する内部分類キーワードの標準がある場合に非常に便利です。

    コンテンツ違反の一致が一定の回数発生してからファイルを違反と見なす場合の一致の最小数を設定できます。 たとえば、コンテンツに 10 個以上のクレジット カード番号が含まれているファイルが検出された場合にアラートを発行するには、10 を選択できます。

    選択した式に対してコンテンツが一致すると、違反テキストが "X" という文字に置き換えられます。 既定では、違反はマスクされ、違反の前後の 100 文字のコンテキストが表示されます。 式のコンテキスト内の数値は "#" という文字に置き換えられ、Cloud App Security 内には格納されません。 **[違反の最後の 4 文字のマスクを解除する]** オプションを選択すると、違反の最後の 4 文字をマスク解除できます。 正規表現で検索するデータ型 (コンテンツ、メタデータ、ファイル名) を設定する必要があります。 既定では、コンテンツとメタデータが検索されます。

1. Cloud App Security で一致が検出された場合に実行する **[ガバナンス]** アクションを選択します。

1. ポリシーを作成したら、 **[ファイル ポリシー]** タブでポリシーを表示できます。ポリシーの編集、フィルターの調整、または自動アクションの変更は、いつでも行うことができます。 ポリシーは作成時に自動的に有効になり、クラウド ファイルのスキャンがすぐに開始されます。  ガバナンス アクションを設定すると、ファイルへのアクセス許可が不可逆的に失われることがあります。 複数の検索フィールドを使用して、処置の対象となるファイルだけが表示されるようにフィルターを絞り込むことをお勧めします。 フィルターを絞り込むほど、良い結果が得られます。 ガイダンスについては、[フィルター] セクションの **[結果の編集とプレビュー]** ボタンを使用できます。

    ![ファイル ポリシーの [結果の編集とプレビュー]](media/file-policy-edit-and-preview-results.png)

1. ファイル ポリシーと一致した、ポリシーに違反している疑いのあるファイルを表示するには、 **[制御]** 、 **[ポリシー]** の順にクリックします。 上部にある **[種類]** フィルターを使用して、ファイル ポリシーのみを表示するように結果をフィルター処理します。 各ポリシーの一致の詳細については、ポリシーをクリックしてください。 これにより、そのポリシーの [現在一致しています] の状態のファイルが表示されます。 **[履歴]** タブをクリックすると、ポリシーに一致したファイルの履歴が最大 6 か月分表示されます。

## <a name="file-policy-reference"></a>ファイル ポリシーのリファレンス

ここでは、ポリシーのリファレンス情報を提供し、各ポリシーの種類と各ポリシーに構成できるフィールドについて説明します。

**ファイル ポリシー** は API ベースのポリシーであり、20 を超えるファイル メタデータ フィルター (所有者と共有レベルを含む) とコンテンツ検査の結果を考慮して、クラウド内の組織のコンテンツを制御できます。 ポリシーの結果に基づいて、ガバナンス アクションを適用できます。 コンテンツ検査エンジンは、サードパーティの DLP エンジンやマルウェア対策ソリューションを使用して拡張できます。

各ポリシーは、次の部分で構成されます。

* **ファイル フィルター** – メタデータに基づいて詳細な条件を作成できます。

* **コンテンツ検査** – DLP エンジンの結果に基づいて、ポリシーを絞り込むことができます。 カスタム式またはプリセット式を含めることができます。 除外を設定することができ、一致の数を選択できます。 匿名化を使用してユーザー名をマスクすることもできます。

* **アクション** – ポリシーには、違反が検出されたときに自動的に適用できる一連のガバナンス アクションが用意されています。  これらのアクションは、コラボレーション アクション、セキュリティ アクション、および調査アクションに分類されます。

* **拡張機能** - コンテンツ検査は、DLP またはマルウェア対策機能を向上させるために、サードパーティ製エンジンを使用して実行できます。

## <a name="file-queries"></a>ファイル クエリ

調査をさらに簡単にするために、カスタム クエリを作成して、後で使用できるように保存することができます。

1. **[ファイル]** ページで、前述のフィルターを使用して、必要に応じてアプリにドリルダウンします。

1. クエリの作成が完了したら、フィルターの右上隅にある **[名前を付けて保存]** ボタンをクリックします。

1. **[クエリの保存]** ポップアップで、クエリに名前を付けます。

1. 後でこのクエリを使用するには、 **[クエリ]** で **[保存されたクエリ]** まで下にスクロールして、クエリを選択します。

## <a name="next-steps"></a>次のステップ

> [!div class="nextstepaction"]
> [クラウド環境を保護するための日常的な作業](daily-activities-to-protect-your-cloud-environment.md)

[!INCLUDE [Open support ticket](includes/support.md)]
