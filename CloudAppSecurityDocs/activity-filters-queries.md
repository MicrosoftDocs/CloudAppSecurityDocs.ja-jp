---
title: Cloud App Security アクティビティフィルターとクエリの操作
description: この記事では Cloud App Security アクティビティフィルターとクエリの一覧を示し、それらの操作方法について説明します。
keywords: ''
author: shsagir
ms.author: shsagir
manager: shsagir
ms.date: 12/10/2018
ms.topic: conceptual
ms.collection: M365-security-compliance
ms.prod: ''
ms.service: cloud-app-security
ms.technology: ''
ms.reviewer: reutam
ms.suite: ems
ms.custom: seodec18
ms.openlocfilehash: f37fab4f9d611577deecb4884838431144f1647d
ms.sourcegitcommit: 4f3883a9e85d0aaf2802b10433b221c3f1838d88
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/13/2020
ms.locfileid: "79285276"
---
# <a name="activity-filters-and-queries"></a>アクティビティ フィルターとクエリ

*適用対象: Microsoft Cloud App Security*

この記事では、Cloud App Security のアクティビティフィルターとクエリの説明と手順について説明します。

## <a name="activity-filters"></a>アクティビティ フィルター

以下に示すのは、適用できるアクティビティ フィルターの一覧です。 ほとんどのフィルターでは、複数の値がサポートされており、ポリシー作成用の強力なツールを提供することはできません。

- アクティビティ ID - ID を使用して特定のアクティビティのみを検索します。 このフィルターは、(SIEM エージェントを使用して) Microsoft Cloud App Security を SIEM に接続し、Cloud App Security ポータル内でアラートをさらに詳細に調査する場合に便利です。

- アクティビティオブジェクト–アクティビティが実行されたオブジェクトを検索します。 このフィルターは、ファイル、フォルダー、ユーザー、またはアプリのオブジェクトに適用されます。
  - アクティビティオブジェクト ID-オブジェクトの ID (ファイル、フォルダー、ユーザー、またはアプリ ID)。
  <!-- - File, folder or site URL - Enables you to select files, folders and URLs that start with a specific string.-->
  <!-- - Target object (file/folder) - Enables you to select a specific file or folder. -->
  - アイテム - アクティビティ オブジェクトの名前または ID で検索できます (例: ユーザー名、ファイル、パラメーター、サイト)。 **[アクティビティオブジェクト項目]** フィルターでは、特定の項目を**含む**、**等しい**、または**開始**する項目をフィルター処理するかどうかを選択できます。

- アクティビティの種類 - アプリ アクティビティを検索します。

- 管理アクティビティ - 管理アクティビティのみを検索します。

- アラート ID: アラート ID で検索します。

- アプリ - 特定のアプリ内のアクティビティのみを検索します。

- 適用されたアクション - 適用されているガバナンス アクション ([ブロック]、[プロキシのバイパス]、[暗号化解除されました]、[暗号化]、[暗号化できませんでした]、[アクションなし]) で検索します。

- 日付 - アクティビティが発生した日付。 フィルターでは、前後の日付と日付範囲がサポートされています。

<!--- Description – Specific keyword in the activity description, for example, all activities that include the string **user** in their description.  -->

- デバイス タグ - 準拠、管理、検証済みのどのデバイスであるかによって検索します。

- デバイスの種類-特定のデバイスの種類を使用して実行されたアクティビティのみを検索します。 たとえば、モバイルデバイス、Pc、またはタブレットからすべてのアクティビティを検索します。

- ファイルとフォルダー-アクティビティが実行されたファイルとフォルダーを検索します。
  - ファイル ID-アクティビティが実行されたファイル ID で検索できます。
  - 名前-ファイルまたはフォルダーの名前をフィルター処理します。 名前の**末尾**がであるか、と**等しい**か、または検索値**で始まる**かを選択できます。
  - 特定のファイルまたはフォルダー-特定のファイルまたはフォルダーを含めたり除外したりすることができます。 ファイルまたはフォルダーを選択すると、**アプリ**、**所有者**、または部分的な**ファイル名**で一覧をフィルター処理できます。

- IP アドレス-アクティビティの実行元の生 IP アドレス、カテゴリ、またはタグ。
  - 生 IP アドレス-または生 IP アドレスによって実行されたアクティビティを検索できます。 未加工 Ip は、特定のシーケンスではなく、等しくない、開始する、または開始しないことができます。
  - IP カテゴリ - アクティビティの実行元の IP アドレスのカテゴリ。管理者の IP アドレス範囲から実行されたすべてのアクティビティなどを指定できます。 カテゴリは、関連する IP アドレスを含むように構成する必要があります。ただし、事前に構成され、匿名プロキシと Tor という2つの IP タグを含む "危険" カテゴリは除きます。 IP カテゴリの構成方法については、「[ニーズに応じたデータの管理](ip-tags.md)」を参照してください。
  - IP タグ - 匿名のプロキシ IP アドレスから実行されたすべてのアクティビティなどの、アクティビティの実行元の IP アドレスのタグ。 Cloud App Security では、構成できない一連の組み込み IP タグが作成されます。 また、独自の IP タグを構成することもできます。 独自の IP タグの構成の詳細については、「[ニーズに応じたデータの管理](ip-tags.md)」を参照してください。
  組み込み IP タグには次のようなものがあります。
    - Microsoft アプリ (このうち 14 個)
    - 匿名プロキシ
    - ボットネット (ボットネットによってアクティビティが実行されたことがわかります。特定のボットネットの詳細については、リンクがあります)
    - IP をスキャンするダークネット
    - マルウェア C&C サーバー
    - リモート接続アナライザー
    - サテライト プロバイダー
    - スマート プロキシとアクセス プロキシ (意図的に除外)
    - Tor 出口ノード
    - Zscaler

- 偽装されたアクティビティ - 別のユーザーの名前で実行されたアクティビティのみを検索します。

- Instance-アクティビティが実行された、または実行されなかったアプリインスタンス。

- 場所 - アクティビティの実行元の国。

- 一致したポリシー - ポータルで設定されている特定のポリシーに一致したアクティビティを検索します。

- 登録された ISP - アクティビティの実行元の ISP。

- ソース - アクティビティが検出されたソースで検索します。 ソースは次のいずれかとなります。
  - アプリ コネクタ - アプリの API コネクタから直接届くログ。
  - アプリ コネクタ分析 - API コネクタによる情報スキャンに基づく Cloud App Security 拡張。

- ユーザー-アクティビティを実行したユーザー。ドメイン、グループ、名前、または組織でフィルター処理できます。 [が設定されていない] 演算子を使用すると、特定のユーザーが存在しないアクティビティをフィルタリングできます。
  - ユーザー ドメイン - 特定のユーザー ドメインを検索します。
  - ユーザー組織 - EMEA マーケティング ユーザーが実行したすべてのアクティビティなどの、アクティビティを実行したユーザーの組織単位。 これは、組織単位を使用して接続された G Suite インスタンスにのみ関連します。
  - ユーザー グループ - Office 365 管理者など、接続されているアプリからインポートできる特定のユーザー グループ。
  - ユーザー名 - 特定のユーザー名を検索します。 特定のユーザー グループ内のユーザーの一覧を表示するには、 **[アクティビティ ドロアー]** で、ユーザー グループの名前をクリックします。 をクリックすると、グループ内のすべてのユーザーが一覧表示された [アカウント] ページに移動します。 そこから、グループ内の特定のユーザーのアカウントの詳細にドリルダウンできます。
  - **[ユーザー グループ]** と **[ユーザー名]** のフィルターは、 **[条件]** フィルターを使用し、次のいずれかのユーザーのロールを選択することで、さらにフィルターすることができます。
    - アクティビティオブジェクトのみ-選択されたユーザーまたはユーザーグループが問題のアクティビティを実行しなかったことを意味します。これらはアクティビティのオブジェクトでした。
    - アクターのみ-ユーザーまたはユーザーグループがアクティビティを実行したことを意味します。
    - ロール-ユーザーまたはユーザーグループがアクティビティに関与していたことを意味します。これは、アクティビティを実行したユーザーまたはアクティビティのオブジェクトとして発生したものです。

- ユーザー エージェント - アクティビティの実行元のユーザー エージェント。

- ユーザー エージェント タグ - 組み込みのユーザー エージェント タグ。古いブラウザーや古いオペレーティング システムから実行されたすべてのアクティビティなどを検索できます。

<!--
>[!NOTE]
> If at any point you want to clear the filters, you can do so by clicking the clear filters icon ![clear filters icon](media/clear-filters.png). -->

## <a name="activity-queries"></a>アクティビティクエリ

調査をさらに簡単にするために、カスタムクエリを作成し、後で使用できるように保存することができます。

1. **[アクティビティログ]** ページで、前述のフィルターを使用して、必要に応じてアプリにドリルダウンします。

2. クエリの作成が完了したら、フィルターの右上隅にある **[名前を付けて保存]** ボタンをクリックします。

3. **[クエリの保存]** ポップアップで、クエリに名前を付けます。

   ![新しいクエリ](media/new-activity-query.png)

4. 今後、このクエリを使用するには、 **[クエリ]** で下にスクロールして **[保存されたクエリ]** を選択し、クエリを選択します。

   ![クエリを開く](media/select-activity-query.png)

また Cloud App Security では、**推奨**されるクエリについても説明します。 提案されたクエリは、アクティビティをフィルター処理するための推奨される調査方法を提供します。 これらのクエリを編集し、をカスタムクエリとして保存できます。 次に、省略可能なクエリを示します。

- 管理アクティビティ-すべてのアクティビティをフィルター処理して、管理者に関連するアクティビティのみを表示します。

- ダウンロードアクティビティ-すべてのアクティビティをフィルター処理して、ダウンロードアクティビティのアクティビティ (.csv vile としてのユーザーリストのダウンロード、共有コンテンツのダウンロード、フォルダーのダウンロードなど) のみを表示します。

- [失敗したログイン]-すべてのアクティビティにフィルター処理を行い、失敗したログオンと、SSO 経由で失敗したサインインのみを表示します。

- ファイルとフォルダーのアクティビティ-すべてのアクティビティをフィルター処理して、ファイルとフォルダーに関連するアクティビティのみを表示します。 このフィルターには、ファイルの作成、削除、アップロード、ダウンロード、検疫、アクセス、およびコンテンツの転送と共に、フォルダーのアップロード、ダウンロード、およびアクセスが含まれます。

- 権限借用アクティビティ-すべてのアクティビティをフィルター処理して、偽装アクティビティのみを表示します。

- メールボックスアクティビティ-すべてのアクティビティにフィルター処理を行い、項目の作成、メールボックスからのメッセージの削除、メッセージの更新、送信 (権限借用) を使用したメッセージの送信など、Microsoft Exchange Online のアクティビティのみを表示します。

- パスワードの変更とリセット要求-すべてのアクティビティにフィルターを適用して、パスワードのリセット、パスワードの変更、および次回のサインイン時にユーザーにパスワードの変更を強制するアクティビティのみを表示します。

- セキュリティリスク-すべてのアクティビティにフィルター処理を適用し、DLP ポリシーに一致するアクティビティのみを表示します。

- アクティビティの共有-すべてのアクティビティにフィルター処理を行い、会社リンクの作成、匿名リンクの作成、読み取り/書き込みアクセス許可の付与など、フォルダーとファイルの共有に関連するアクティビティのみを表示します。

- 成功したログイン-すべてのアクティビティにフィルター処理を行います。これには、権限の借用アクション、ログオンの権限の借用、シングルサインオンログオン、新しいデバイスからのログオンなど、成功したログインだけが表示されます。

![クエリアクティビティ](media/queries-activity.png)

また、提案されたクエリを新しいクエリの開始点として使用することもできます。 まず、提案されたクエリのいずれかを選択します。 次に、必要に応じて変更を行い、最後に [名前を付け**て保存**] をクリックして、**保存されたクエリ**を新規作成します。

## <a name="next-steps"></a>次のステップ:

> [!div class="nextstepaction"]
> [クラウド環境を保護するための日常的な作業](daily-activities-to-protect-your-cloud-environment.md)
